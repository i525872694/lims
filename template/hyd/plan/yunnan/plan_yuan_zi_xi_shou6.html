<table class="noborder">
    <tr align="right">
        <td colspan="15">监-10-1</td>
    </tr>
</table>
<h1>原子吸收、原子荧光及光度计比色法测定原始记录表</h1>
{$hjtj_bt}
<input type="hidden" id="L" value="$arow[td6]">
<table class="single center">
    <tr class="noborder">
        <td style="width:8.3%">
        <td style="width:7.3%">
        <td style="width:7.3%">
        <td style="width:7.3%">
        <td style="width:8.3%">
        <td style="width:9.3%">
        <td style="width:9.3%">
        <td style="width:8.3%">
        <td style="width:9.3%">
        <td style="width:8.3%">
        <td style="width:8.3%">
        <td style="width:8.3%">
    </tr>
    <tr>
        <td colspan="1">测定项目</td>
        <td colspan="2">{$arow['assay_element']}</td>
        <td colspan="1">测定方法</td>
        <td colspan="2">{$arow['td2']} </td>
        <td colspan="1">仪器名称</td>
        <td colspan="2">$arow[td4]</td>
        <td colspan="1">仪器编号</td>
        <td colspan="2">{$arow['yq_bh']}</td>
    </tr>
    <tr>
        <td colspan="1">选用波长(nm)</td>
        <td colspan="1"><input type="text" name='td7' value='$arow[td7]' /></td>
        <td colspan="1">狭缝(nm)</td>
        <td colspan="1"><input type="text" name='td10' value='$arow[td10]'></td>
        <td colspan="1">乙炔流量(L/min)</td>
        <td colspan="1"><input type="text" name='td12' value='$arow[td12]'></td>
        <td colspan="2">空气流量(L/min)</td>
        <td colspan="1"><input type="text" name='td13' value='$arow[td13]'></td>
        <td colspan="2">载气流量(L/min)</td>
        <td colspan="1"><input type="text" name="td16" value="$arow[td16]" /></td>
    </tr>
    <tr>
        <td colspan="1">灯电流(mA)</td>
        <td colspan="1"><input type="text" name='td11' value='$arow[td11]'></td>
        <td colspan="1">火焰高度(mm)</td>
        <td colspan="1"><input type="text" name='td14' value='$arow[td14]'></td>
        <td colspan="1">比色皿规格(mm)</td>
        <td colspan="1"><input type="text" name="td17" value="$arow[td17]" /></td>
        <td colspan="2">标液浓度(mg/L)</td>
        <td colspan="1"><input type="text" name="td18" value="$arow[td18]" /></td>
        <td colspan="2">定容体积(mL)</td>
        <td colspan="1"><input type="text" name="td6" value="$arow[td6]" /></td>
    </tr>
    <tr>
        <td class="change_qx blue_a" title="点击选择曲线">曲线方程</td>
        <td colspan="4">{$arow['quxian']}</td>
        <td colspan="1" class="view_qx blue_a">绘制日期</td>
        <td colspan="2">{$arow['sc_ldrq']}</td>
        <td colspan="1">截距检验</td>
        <td colspan="1" id="CT">{$arow['CT']}</td>
        <td colspan="1">相关系数</td>
        <td colspan="1">{$arow['CR']}</td>
    </tr>
    <tr align="center">
        <td rowspan="2">序号</td>
        <td rowspan="2" colspan="2">水样名称</td>
        <td rowspan="2">采样日期</td>
        <td rowspan="2">水样体积(mL)</td>
        <td colspan="4">光密度</td>
        <td colspan="1" rowspan='2'> 含量({$arow['unit']})</td>
        <td rowspan="2">平均值({$arow['unit']})</td>
        <td rowspan="2">相对偏差/加标回收率(%)</td>
    </tr>
    <tr align="center">
        <td>I</td>
        <td>II</td>
        <td>平均</td>
        <td>减空白</td>
    </tr>
    <tr>
        <td>&nbsp;</td>
        <td colspan="2">空白1</td>
        <td></td>
        <td><input type="text" class="inputc" name="btdata[101]" value="{$arow['btdata'][101]}" onblur="func()" style="font-size: 12px;"></td>
        <td><input type="text" class="inputc" name="btdata[102]" value="{$arow['btdata'][102]}" onblur="func()" style="font-size: 12px;"></td>
        <td><input type="text" class="inputc" name="btdata[103]" value="{$arow['btdata'][103]}" onblur="func()" style="font-size: 12px;"></td>
        <td><input type="text" class="noinputc" name="btdata[104]" value="{$arow['btdata'][104]}" style="font-size: 12px;"></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
    </tr>
    <tr>
        <td>&nbsp;</td>
        <td colspan="2">空白2</td>
        <td></td>
        <td><input type="text" class="inputc" name="btdata[201]" value="{$arow['btdata'][201]}" onblur="func()" style="font-size: 12px;"></td>
        <td><input type="text" class="inputc" name="btdata[202]" value="{$arow['btdata'][202]}" onblur="func()" style="font-size: 12px;"></td>
        <td><input type="text" class="inputc" name="btdata[203]" value="{$arow['btdata'][203]}" onblur="func()" style="font-size: 12px;"></td>
        <td><input type="text" class="noinputc" name="btdata[204]" value="{$arow['btdata'][204]}" style="font-size: 12px;"></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
    </tr>
    <tr>
        <td>&nbsp;</td>
        <td colspan="2">平均</td>
        <td></td>
        <td>/</td>
        <td>/</td>
        <td>/</td>
        <td><input type="text" class="noinputc" name="btdata[301]" value="{$arow['btdata'][301]}" style="font-size: 12px;"></td>
        <td></td>
        <td></td>
        <td></td>
        <td></td>
    </tr>
    {$aline}
    <tr class="noborder"></tr>
</table>
<script type="text/template" class="extrajs_{$arow['id']}">
    if($('#CT').html()!='' && $('#CT').html()!='不合格'){
        $('#CT').html('合格');
    }
</script>
<script type="text/javascript">
eval($(".extrajs_{$arow['id']}").html());

function func() {
    var strArr = $("[name='btdata[102]']").val().toString().split(".");
    if (strArr.length == 2) {
        var numlen11 = strArr[1].length;
    } else {
        var numlen11 = 2;
    }
    var strArr = $("[name='btdata[202]']").val().toString().split(".");
    if (strArr.length == 2) {
        var numlen21 = strArr[1].length;
    } else {
        var numlen21 = 2;
    }
    if ($.isNumeric($("[name='btdata[102]']").val()) && $.isNumeric($("[name='btdata[103]']").val())) {
        $("[name='btdata[104]']").val(roundjs(accDiv(accAdd($("[name='btdata[102]']").val(), $("[name='btdata[103]']").val()), 2), numlen11));
        // $("[name='btdata[104]']").val(roundjs(accsub($("[name='btdata[102]']").val(), accMul($("[name='btdata[103]']").val(), 2)), numlen11));
    } else if ($.isNumeric($("[name='btdata[102]']").val())) {
        $("[name='btdata[104]']").val($("[name='btdata[102]']").val());
    } else {
        $("[name='btdata[104]']").val('');
    }
    if ($.isNumeric($("[name='btdata[202]']").val()) && $.isNumeric($("[name='btdata[203]']").val())) {
        $("[name='btdata[204]']").val(roundjs(accDiv(accAdd($("[name='btdata[202]']").val(), $("[name='btdata[203]']").val()), 2), numlen21));
        // $("[name='btdata[204]']").val(roundjs(accsub($("[name='btdata[202]']").val(), accMul($("[name='btdata[203]']").val(), 2)), numlen21));
    } else if ($.isNumeric($("[name='btdata[202]']").val())) {
        $("[name='btdata[204]']").val($("[name='btdata[202]']").val());
    } else {
        $("[name='btdata[204]']").val('');
    }

    if ($.isNumeric($("[name='btdata[104]']").val()) && $.isNumeric($("[name='btdata[204]']").val())) {
        $("[name='btdata[301]']").val(roundjs(accDiv(accAdd($("[name='btdata[104]']").val(), $("[name='btdata[204]']").val()), 2), numlen11));
    } else if ($.isNumeric($("[name='btdata[104]']").val())) {
        $("[name='btdata[301]']").val($("[name='btdata[104]']").val());
    } else {
        $("[name='btdata[301]']").val('');
    }
}

function jsgs() {
    func();
    var kb = $("[name='btdata[301]']").val();
    $.isNumeric(kb) ? '' : kb = 0;

    //运算函数在lib.js
    var vid = $arow[vid];
    var sc_unit = "{$arow['sc_unit']}";
    // console.log(vid);
    // console.log(sc_unit);
    //vid94是浊度，不需判断是质量曲线还是浓度曲线
    if ($.isNumeric($("input[name=td6]").val()) && $.isNumeric(vs['vd1'])) {
        if (sc_unit.split('/').length == 2 || vid == '94' || sc_unit == '度' || sc_unit == 'NTU') {
            var qy_v = 1;
            var vd2 = parseFloat($("input[name=td6]").val() / vs['vd1']); //稀释倍数
        } else {
            var qy_v = parseFloat(vs['vd1']);
            var vd2 = 1;
        }
    } else {
        $("input[name=td6]").focus();
        var vd2 = qy_v = '';
    }

    var vd6_split = String(vs['vd6']).split('.');
    if (vd6_split.length == 2) {
        var diding_ws = vd6_split[1].length;
    } else {
        var diding_ws = 2;
    }

    var vd6 = parseFloat(vs['vd6']);
    var vd7 = parseFloat(vs['vd7']);
    // var vd6 = vs['vd6'];//I
    // var vd7 = vs['vd7'];//II
    if ($.isNumeric(vd6) && $.isNumeric(vd7)) {
        var pj = vs['vd8'] = roundjs(accDiv(accAdd(vd6, vd7), 2), diding_ws); //获取平均值
    } else {
        var pj = vs['vd8'] = '';
    }

    if ($.isNumeric(kb) && $.isNumeric(vs['vd8'])) {
        vs['vd9'] = roundjs(accsub(pj, kb), diding_ws); //获取回归方程中Y的值，即(A)-(A0)的值
    } else {
        vs['vd9'] = '';
    }

    if ($.isNumeric(vs['vd9'])) {
        if (vs['vd9'] == 0) {
            vs['vd0'] = 0;
        } else {
            var CA = "{$arow['CA']}";
            var CB = "{$arow['CB']}";
            if ($.isNumeric(CA) && $.isNumeric(CB) && $.isNumeric(vd2) && $.isNumeric(qy_v)) {
                var han1 = accsub(vs['vd9'], CA); //计算公式
                var han2 = accDiv(han1, CB);
                var jg = parseFloat(accMul(han2, vd2));
                // console.log(han2);
                // console.log(vd2);
                // console.log(jg);
                // console.log(qy_v);
                vs['vd0'] = jsws(accDiv(jg, qy_v));
            } else {
                vs['vd0'] = '';
            }
        }
    } else {
        vs['vd0'] = '';

    }
}

</script>
