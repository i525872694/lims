<table class="hide noborder">
    <tr align="right">
        <td>监-**</td>
    </tr> 
</table>
<h1>粪大肠菌群(发酵法)测定记录表</h1>
{$hjtj_bt}
<table class="single center">
    <tr class="noborder">
        <td style="width:4%"></td> <td style="width:8%"></td> <td style="width:7%"></td> <td style="width:7%"></td> 
        <td style="width:7%"></td> <td style="width:9%"></td> <td style="width:9%"></td> <td style="width:7%"></td>
        <td style="width:7%"></td> <td style="width:7%"></td> <td style="width:6%"></td> <td style="width:8%"></td>
        <td style="width:8%"></td> <td style="width:6%"></td>
    </tr>
    <tr>
        <td colspan="2">检测项目</td>
        <td colspan="4">{$arow['assay_element']}</td>
        <td colspan="2">测定方法</td>
        <td colspan="6">{$arow['td2']}</td>
    </tr>
    <tr>
        <td>序号</td>
        <td>{$zhanming}</td>
        <td>水样体积（mL）</td>
        <td>稀释倍数</td>
        <td>采样日期</td>
        <td>接种日期</td>
        <td>完成日期</td>
        <td>初发酵<br>(管数)</td>
        <td>接种日期</td>
        <td>完成日期</td>
        <td>复发酵<br>(管数)</td>
        <td>粪大肠菌群<br>({$arow['unit']})</td>
        <td>平均值<br>({$arow['unit']})</td>
        <td>质控结果(%)</td>
    </tr>
    {$aline}
  <tr class="noborder"></tr>
</table>
<script type="text/javascript">
if(!$("[name^='vd1[']").val()){
    $("[name^='vd1[']").val('10.00');
}
if(!$("[name^='vd13[']").val()){
    $("[name^='vd13[']").val('1.00');
}
if(!$("[name^='vd16[']").val()){
    $("[name^='vd16[']").val('0.10');
}

function jsgs(){
    var unit = "{$arow['unit']}";
    var xsbs = $.isNumeric(vs['vd2']) ? vs['vd2'] : 1;
    if(xsbs == 10){
        vs['vd1'] = roundjs(1,2);
        vs['vd13'] = roundjs(0.1,2);
        vs['vd16'] = roundjs(0.01,2);
    }
    if(!vs['vd1']){
        vs['vd1'] = roundjs(accDiv(10,xsbs),2);
    }
    if(!vs['vd13']){
        vs['vd13'] = roundjs(accDiv(1,xsbs),2);
    }
    if(!vs['vd16']){
        vs['vd16'] = roundjs(accDiv(0.1,xsbs),2);
    }

    var td2 = "{$arow['td2']}";
    if(td2 == 'GB/T 5750.12-2006'){
        var fh = '>';
        var arrnum = 1600;
    }else{
        var fh = '≥';
        var arrnum = 2400;
    }

    var array=[ [0,0,0,0],  [0,0,1,2], [0,0,2,4], [0,0,3,5], [0,0,4,7], [0,0,5,9], 
        [0,1,0,2],  [0,1,1,4], [0,1,2,6], [0,1,3,7], [0,1,4,9], [0,1,5,11], 
        [0,2,0,4],  [0,2,1,6], [0,2,2,7], [0,2,3,9], [0,2,4,11], [0,2,5,13], 
        [0,3,0,6],  [0,3,1,7], [0,3,2,9], [0,3,3,11], [0,3,4,13], [0,3,5,15], 
        [0,4,0,8],  [0,4,1,9], [0,4,2,11], [0,4,3,13], [0,4,4,15], [0,4,5,17], 
        [0,5,0,9],  [0,5,1,11], [0,5,2,13], [0,5,3,15], [0,5,4,17], [0,5,5,19], 

        [1,0,0,2],  [1,0,1,4], [1,0,2,6], [1,0,3,8], [1,0,4,10], [1,0,5,12], 
        [1,1,0,4],  [1,1,1,6], [1,1,2,8], [1,1,3,10], [1,1,4,12], [1,1,5,14], 
        [1,2,0,6],  [1,2,1,8], [1,2,2,10], [1,2,3,12], [1,2,4,15], [1,2,5,17], 
        [1,3,0,8],  [1,3,1,10], [1,3,2,12], [1,3,3,15], [1,3,4,17], [1,3,5,19], 
        [1,4,0,11],  [1,4,1,13], [1,4,2,15], [1,4,3,17], [1,4,4,19], [1,4,5,22], 
        [1,5,0,13],  [1,5,1,15], [1,5,2,17], [1,5,3,19], [1,5,4,22], [1,5,5,24], 

        [2,0,0,5],  [2,0,1,7], [2,0,2,9], [2,0,3,12], [2,0,4,14], [2,0,5,16], 
        [2,1,0,7],  [2,1,1,9], [2,1,2,12], [2,1,3,14], [2,1,4,17], [2,1,5,19], 
        [2,2,0,9],  [2,2,1,12], [2,2,2,14], [2,2,3,17], [2,2,4,19], [2,2,5,22], 
        [2,3,0,12],  [2,3,1,14], [2,3,2,17], [2,3,3,20], [2,3,4,22], [2,3,5,25], 
        [2,4,0,15],  [2,4,1,17], [2,4,2,20], [2,4,3,23], [2,4,4,25], [2,4,5,28], 
        [2,5,0,17],  [2,5,1,20], [2,5,2,23], [2,5,3,26], [2,5,4,29], [2,5,5,32], 

        [3,0,0,8],  [3,0,1,11], [3,0,2,13], [3,0,3,16], [3,0,4,20], [3,0,5,23], 
        [3,1,0,11],  [3,1,1,14], [3,1,2,17], [3,1,3,20], [3,1,4,23], [3,1,5,27], 
        [3,2,0,14],  [3,2,1,17], [3,2,2,20], [3,2,3,24], [3,2,4,27], [3,2,5,31], 
        [3,3,0,17],  [3,3,1,21], [3,3,2,24], [3,3,3,28], [3,3,4,32], [3,3,5,36], 
        [3,4,0,21],  [3,4,1,24], [3,4,2,28], [3,4,3,32], [3,4,4,36], [3,4,5,40], 
        [3,5,0,25],  [3,5,1,29], [3,5,2,32], [3,5,3,37], [3,5,4,41], [3,5,5,45], 

        [4,0,0,13], [4,0,1,17], [4,0,2,21], [4,0,3,25], [4,0,4,30], [4,0,5,36], 
        [4,1,0,17], [4,1,1,21], [4,1,2,26], [4,1,3,31], [4,1,4,36], [4,1,5,42], 
        [4,2,0,22], [4,2,1,26], [4,2,2,32], [4,2,3,38], [4,2,4,44], [4,2,5,50], 
        [4,3,0,27], [4,3,1,33], [4,3,2,39], [4,3,3,45], [4,3,4,52], [4,3,5,59], 
        [4,4,0,34], [4,4,1,40], [4,4,2,47], [4,4,3,54], [4,4,4,62], [4,4,5,69], 
        [4,5,0,41], [4,5,1,48], [4,5,2,56], [4,5,3,64], [4,5,4,72], [4,5,5,81], 

        [5,0,0,23], [5,0,1,31], [5,0,2,43], [5,0,3,58], [5,0,4,76],  [5,0,5,95], 
        [5,1,0,33], [5,1,1,46], [5,1,2,63], [5,1,3,84], [5,1,4,110], [5,1,5,130], 
        [5,2,0,49], [5,2,1,70], [5,2,2,94], [5,2,3,120],[5,2,4,150], [5,2,5,180], 
        [5,3,0,79], [5,3,1,110],[5,3,2,140],[5,3,3,180],[5,3,4,210], [5,3,5,250], 
        [5,4,0,130],[5,4,1,170],[5,4,2,220],[5,4,3,280],[5,4,4,350], [5,4,5,430], 
        [5,5,0,240],[5,5,1,350],[5,5,2,540],[5,5,3,920],[5,5,4,1600],[5,5,5,arrnum],
    ];
 
    var tj1=vs['vd1'];
    var tj2=vs['vd13'];
    var tj3=vs['vd16'];
    var arrs=[tj1,tj2,tj3];
    arrs.sort(function(a,b){return a<b?1:-1});//从大到小排序

    if($.isNumeric(vs['vd12']) && $.isNumeric(vs['vd15']) && $.isNumeric(vs['vd18'])){
        var vd12 = vs['vd12'];
        var vd15 = vs['vd15'];
        var vd18 = vs['vd18'];
    }else if($.isNumeric(vs['vd7']) && $.isNumeric(vs['vd14']) && $.isNumeric(vs['vd17'])){
        var vd12 = vs['vd7'];
        var vd15 = vs['vd14'];
        var vd18 = vs['vd17'];
    }

    //获取用户输入的体积，如果三个是10,1,0.1 那就查Mpn表，  
    if ($.isNumeric(vd12) && $.isNumeric(vd15) && $.isNumeric(vd18)) {

        if (arrs[0] == 10 && arrs[1] == 1 && arrs[2] == 0.1) {
            var usearr = [vd12, vd15, vd18]; //获取用户输入的三个值并转换为数组
            for (var i = 0; i < array.length; i++) {
                var ajsd = 1;
                for (var j = 0; j < usearr.length; j++) {
                    if (usearr[j] != array[i][j]) {
                        ajsd = 2;
                        continue;
                    }
                }
                if (ajsd == 1) {
                    var jg = array[i][3];
                }
            }
            // var zjg = accMul(jg, xsbs);
            if(unit == '个/100mL' || unit == 'CFU/100mL'){
                var zjg = accMul(jg, xsbs);
            }else{
                var zjg = accMul(accMul(jg, xsbs), 10);
            }
            if (vd12 == "5" && vd15 == "5" && vd18 == "5") {
                vs['vd0'] = fh + zjg;
            // } else if (vd12 == "0" && vd15 == "0" && vd18 == "0") {
            //     vs['vd0'] = "<" + zjg;
            } else {
                vs['vd0'] = zjg;
            }

        } else if (accMul(arrs[0], xsbs) == 10 && accMul(arrs[1], xsbs) == 1 && accMul(arrs[2], xsbs) == 0.1) { //此处应该是计算比例的,计算第一二三个值和10,1,0.1的比例,但是不知道他们是怎么算得,先这么用把
            var usearr = [vd12, vd15, vd18];
            for (var i = 0; i < array.length; i++) {
                if (array[i][0] == usearr[0] && array[i][1] == usearr[1] && array[i][2] == usearr[2]) {
                    var jg = array[i][3];
                }
            }
            if(unit == '个/100mL' || unit == 'CFU/100mL'){
                var zjg = accMul(jg, xsbs);
            }else{
                var zjg = accMul(accMul(jg, xsbs), 10);
            }
            // var zjg = accMul(jg, xsbs);
            if (vd12 == "5" && vd15 == "5" && vd18 == "5") {
                vs['vd0'] = fh + zjg;
            // } else if (vd12 == "0" && vd15 == "0" && vd18 == "0") {
            //     vs['vd0'] = "<" + zjg;
            } else {
                vs['vd0'] = zjg;
            }
        } else {
            vs['vd0'] = '';
        }

    } else {
        vs['vd0'] = '';
    }

}

</script>