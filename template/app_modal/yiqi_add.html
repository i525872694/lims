<br />
<h3 class="header smaller center title">添加仪器</h3>
<br /><br />
<form name="myform" action="yiqi_add.php" method="post" onSubmit="return check(this);" enctype="multipart/form-data">
	<table class="table table-striped table-bordered table-hover center" style="width:20cm">
		<tr align="center">
			<th style="width:2cm;">仪器名称</th>
			<td class=inputl><input type="text" class=inputc name="yq_mingcheng" size="20" value="{$yiqi_arr['yq_mingcheng']}" /></td>
			<th style="width:2cm">制造厂商</th>
			<td>
				<input type='text' name='yq_zzcangjia' value="{$yiqi_arr['yq_zzcangjia']}">
			</td>
		</tr>
		<tr align="center">
			<td style="width:2cm;">购置价格</td>
			<td style="width:7cm;"><input type="text" class=inputc name="yq_jiage" size="20" value="{$yiqi_arr['yq_jiage']}" /> 万元</td>
			<td>型号</td>
			<td><input type="text" class=inputc name="yq_xinghao" size="20" value="{$yiqi_arr['yq_xinghao']}" /></td>
		</tr>
		<tr align="center">
			<td>出厂编号</td>
			<td><input type="text" class=inputc name="yq_chucangbh" size="20" value="{$yiqi_arr['yq_chucangbh']}" /></td>
			<td>内部编号</td>
			<td><input type="text" class=inputc name="yq_neibubh" size="20" value="{$yiqi_arr['yq_neibubh']}" /></td>
		</tr>
		<tr align="center">
			<td>购置日期</td>
			<td><input type="date" class="inputc date_input" name="yq_gouzhirq" id="yq_gouzhirq" size="20" value="{$yiqi_arr['yq_gouzhirq']}"
				 onclick="opentime('yq_gouzhirq','all');getxy(this);"/>
			</td>
			<td>管理员</td>
			<td><input type="text" class=inputc name="yq_baoguanren" size="20" value="{$yiqi_arr['yq_baoguanren']}" /></td>
		</tr>
		<tr align="center">
			<td>是否有湿温度要求</td>
			<td colspan='3'>
				<select name="is_shiwen" id="shiwen" onchange='shiwen_show()'>
					<option value='1' selected="selected">有要求</option>
					<option value='0'>无要求</option>
				</select>
			</td>
		</tr>
		<tr align="center" style='display:none' id='shidu'>
			<td>室温上限°C</td>
			<td><input type="text" class=inputc name="shidu_max" size="20" value="{$yiqi_arr['shidu_max']}" />°C</td>
			<td>室温下限°C</td>
			<td><input type="text" class=inputc name="shidu_min" size="20" value="{$yiqi_arr['shidu_min']}" />°C</td>
		</tr>
		<tr align="center" style='display:none' id='wendu'>
			<td>湿度上限%</td>
			<td><input type="text" class=inputc name="wendu_max" size="20" value="{$yiqi_arr['wendu_max']}" />%</td>
			<td>湿度下限%</td>
			<td><input type="text" class=inputc name="wendu_min" size="20" value="{$yiqi_arr['wendu_min']}" />%</td>
		</tr>
		<tr align="center">
			<td>最近检定日期</td>
			<td><input type="date" class="inputc date_input" name="yq_jiandingriqi" id="yq_jiandingriqi" size="20" value="{$yiqi_arr['yq_jiandingriqi']}" />
			</td>
			<td>报废日期</td>
			<td><input type="date" class="inputc date_input" size="20" value="{$yiqi_arr[yq_baofei]}"/>
			</td>
		</tr>
		<tr align="center">
			<td >生产日期</td>
			<td><input type="date" name="yq_scriqi" id="yq_scriqi" size="20" value="{$yiqi_arr['yq_scriqi']}" />
			</td>
			<th>仪器图片</th>
			<td>
				<input type="file" id='img_upload' size="20" value="{$yiai_arr['yq_image']}" />
				<input type='hidden' id='base64_code' name='yq_new_image'>
				<p id="img_area"></p>
			</td>
		</tr>
		<tr align="center">
			<th>仪器存放楼层</th>
			<td><input type="text" name="yq_lou" class="inputc" size="20" value="{$yiqi_arr['yq_lou']}" /></td>
			<th>仪器存放房间</th>
			<td><input type="text" name="yq_room" class="inputc" size="20" value="{$yiqi_arr['yq_room']}" /></td>
		</tr>
		<tr>
			<td colspan="4">
				<center><input type='submit' class='btn btn-xs btn-primary no-print'> <input class='btn btn-xs btn-primary' type="button"       onclick="window.location.href='{$rooturl}/app_modal/yiqi_list.php'" value="取消"></td>
		</tr>
	</table>
</form>
<script>
	shiwen_show();
	function shiwen_show(){
		if($('#shiwen').val()=='1'){
			$('#shidu').show();
			$('#wendu').show();
		}
		if($('#shiwen').val()=='0'){
			$('#shidu').hide();
			$('#wendu').hide();
		}
	}
</script>
<!--为了实验室仪器一览返回功能-->
<script type="text/javascript">
	function go_back() {
		history.back();
	}

</script>
<script>
	$('#myModal').on('shown.bs.modal', function () {
		$('#myInput').focus()
	})
	//仪器图片隐藏功能
	function delete_image(obj, id) {
		$.post('yiqi_save.php', { 'handle': 'delete_image', 'id': id }, function (data) {
			if (data == 'ok') {
				alert('删除成功');
				$(obj).parent('td').find('a').detach();
			} else {
				alert('删除失败！');
			}
		});
	}

</script>
<style>
	ul li {
		list-style: none;
	}
</style>
<script type="text/javascript">
	window.onload = function () {
		// 抓取上传图片，转换代码结果，显示图片的dom
		var img_upload = document.getElementById("img_upload");
		var base64_code = document.getElementById("base64_code");
		var img_area = document.getElementById("img_area");
		// 添加功能出发监听事件
		img_upload.addEventListener('change', readFile, false);
	}
	function readFile() {
		var file = this.files[0];
		if (!/image\/\w+/.test(file.type)) {
			alert("请确保文件为图像类型");
			return false;
		}
		var reader = new FileReader();
		reader.readAsDataURL(file);
		reader.onload = function () {
			base64_code.value = this.result;
			console.log(this.result.length);
			img_area.innerHTML = '<div>图片img标签展示：</div><img src="' + this.result + '" alt="" style="width:50%"/>';
		}
	}
</script>
